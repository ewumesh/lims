<div class="row m-0" style="padding: 1%;">
  <div class="col-md-10"> 
    <h2>Raw Data Sheet</h2>
  </div>
  <div class="col-md-2 text-end">
    <button (click)="closeDialog()" class="btn btn-lims-danger btn-sm"><mat-icon aria-hidden="false" aria-label="edit"
        fontIcon="close"></mat-icon></button>
  </div>
  <hr />
  <mat-dialog-content>
    <!-- <mat-card> -->
    <!-- <div class="sample-dialog" style="border: 1px solid #0000001a;
    padding: 12px;
    border-radius: 5px;">
      <div class="row">
        <div class="col-md-6">
          <p class="title">Name of Laboratory</p>
          <h2 class="detail">N/A</h2>
        </div>
        <div class="col-md-6">
          <p class="title">Reported date </p>
          <h2 class="detail">{{data?.sample[0]?.sample_form?.created_date | date: 'medium' || 'N/A'}}</h2>
        </div>
      </div>
      <div class="row">
        <div class="col-md-4">
          <p class="title">Sample Name</p>
          <h2 class="detail">{{data?.sample[0].sample_form.name | titlecase}}</h2>
        </div>
        <div class="col-md-4">
          <p class="title">Date of Receipt</p>
          <h2 class="detail">{{rawDatasheetDetails?.created_date | date: 'medium'}}</h2>
        </div>
        <div class="col-md-4">
          <p class="title">Sample Codes</p>
          <h2 class="detail text-uppercase">{{data?.sample[0].sample_form?.id || 'N/A'}}</h2>
        </div>
      </div>
      <div class="row">
        <div class="col-md-4">
          <p class="title">Due Date</p>
          <h2 class="detail">{{rawDatasheetDetails?.created_date | date: 'medium'}}</h2>
        </div>
        <div class="col-md-4">
          <p class="title">Started on</p>
          <h2 class="detail">{{rawDatasheetDetails?.created_date | date: 'medium'}}</h2>
        </div>
        <div class="col-md-4">
          <p class="title">Completed on </p>
          <h2 class="detail">{{rawDatasheetDetails?.created_date | date: 'medium'}}</h2>
        </div>
      </div>
      <div class="row">
        <div class="col-md-12">
          <p class="title">Parameters to be analyzed</p>
          <h2 class="detail">N/A</h2>
        </div>
      </div>
      <div class="row">
        <div class="col-md-12">
          <p class="title">Method of Analysis/Testing</p>
          <h2 class="detail">N/A</h2>
        </div>
      </div>
      <div class="row">
        <div class="col-md-12">
          <p class="title">RAW DATA (Observations, Readings, calculations etc.) </p>
        </div>
      </div>
      <div class="row">
        <div class="col-md-6" *ngFor="let p of rawDatasheetDetails?.raw_data">
          <hr/>
          <div class="formula">
            <h2>{{p.parameter?.name}}</h2>
            <div *ngIf="p?.parameter?.formula_notation">
              <div *ngFor="let n of splitStringByComma(p?.parameter?.formula_notation)">
                <span class="text-danger">*</span>{{n | titlecase}}
              </div>
              <h2>Formula = {{p?.parameter?.formula}}</h2>
            </div>
            <div *ngIf="!p?.parameter?.formula_notation" class="text-muted">N/A</div>
          </div>
        </div>

        <div class="col-md-12">
          <h3 class="text-bold">Remarks</h3>
          <p>{{rawDatasheetDetails?.remarks}}</p>
        </div>

      </div>
    </div> -->

    <table  class="top-table">
      <tr >
          <td style="width:11%; padding: 6px; position: relative;">
              <img src="https://logos-download.com/wp-content/uploads/2021/07/Emblem_of_Nepal.png" alt="logo" style="width: 60px;">
          </td>
          <td style="width: 70%;  border-right: 0;">
              <h2 >National Food and Feed Reference Laboratory  </h2>
              <p>DFTQC, Kathmandu, Nepal</p>
          </td>
          <td style=" border-left: 0;">
              <p >{{data.data.id}}</p>
          </td>
      </tr>
</table>

<h2 class="heading" >NFFRL/SR/7.5/03: RAW DATA WORKSHEET 
  <!-- (Chemical) -->
</h2>

<table style="width: 100%;" class="bottom-table"> 
  <tr>
      <th class="text-center" >S.N.</th>
      <th colspan="5"> Commodity Category: <span class="detail"> {{data?.sample[0]?.sample_form_has_parameter?.commodity?.category?.name || '-'}} </span></th>
      <th colspan="4"> Reported date:<span class="detail"> {{convertToNepaliDate(data?.sample[0].completed_date)}}</span> </th>
  </tr>
  <tr>
      <td class="text-center">1</td>
      <td colspan="3">Sample Name: <span class="detail"> {{data?.sample[0].sample_form?.name || '-'}} </span></td>
      <td colspan="3"> Date of Receipt: <span class="detail"> {{data?.sample[0]?.sample_received_date}}  </span></td>
      <td colspan="3"> Sample Codes: <span class="detail">
        <span *ngIf="!data?.sample[0]?.sample_form?.namuna_code">{{data?.sample[0].sample_form?.id || '-'}}</span> 
        <span *ngIf="data?.sample[0]?.sample_form?.namuna_code">{{data?.sample[0].sample_form?.namuna_code || '-'}}</span> 
      </span></td>
  </tr>

  <tr>
      <td class="text-center">2</td>
      <!-- <td colspan="3">Due Date:<span class="detail"> {{data?.sample[0].created_date | date: 'medium'}} </span></td> -->
      <td colspan="5">Started on:<span class="detail"> {{data?.data?.started_date}} </span></td>
      <td colspan="4">Completed on:<span class="detail"> {{convertToNepaliDateC(data?.data?.completed_date) }} </span></td>
  </tr>

  <tr>
      <td class="text-center">3</td>
      <td colspan="10">Parameters to be analyzed:<span class="detail"> <span *ngFor="let a of rawDatasheetDetails?.raw_data">{{a.parameter?.name}},</span> </span></td>
  </tr>
  <tr>
      <td class="text-center">4</td>
      <td colspan="10">Method of Analysis/Testing: <span *ngFor="let a of rawDatasheetDetails?.raw_data" class="detail"> ({{a?.test_method}}), </span></td>
  </tr>

  <tr style="border-bottom: none;">
      <td style=" border-bottom: none;" class="text-center"> 5</td>
      <td colspan="10" style="border-bottom: none;" >RAW DATA (Observations, Readings, calculations etc.)<span class="detail"></span>

      </td>
  </tr>

  <tr style="border-top: none; border-bottom: none;">
      <td style="border-top: none; border-bottom:none;"></td>
      <td colspan="10" style="border-top: none; border-bottom:none;">
          <div class="row m-2">
              <div class="col-md-12" *ngFor="let p of rawDatasheetDetails?.raw_data">
                  <hr />
                  <div class="row">
                    <div class="col-md-6">
                      <div class="formula">
                        <h2>{{p.parameter?.name|| '-'}}</h2>
                        <div >
                          <div *ngIf="p?.parameter?.formula_notation">
                          <div *ngFor="let n of splitStringByComma(p?.parameter?.formula_notation)">
                            <span class="text-danger">*</span>{{n | titlecase}}
                          </div>
                          </div>
                          <h2>Formula = {{p?.parameter?.formula || '-'}}</h2>
                          <!-- <h2>Result = {{p?.result}}</h2>
                                <h2>Final Result = {{p?.final_result || 'N/A'}}</h2>
                                <h2 *ngIf="!p.analyst_remarks ">Qualitative Analysis = <span [innerHtml]="p?.analyst_remarks"></span></h2> -->
                        </div>
                        <!-- <div *ngIf="!p?.parameter?.formula_notation" class="text-muted">N/A</div> -->
                      </div>
                    </div>
                    <div class="col-md-6">
                      <div *ngFor="let item of parseJSON(p?.input_fields_value) | keyvalue">
                        <span>{{item.key}}</span> = <span>{{item.value}}</span>
                   </div>
                   <div>Result: {{p.result || '-'}}</div>
                   <div>Final Result: {{p.converted_result || '-'}}</div>
                   <div *ngIf="p.additional_info">Additional Info: {{p.additional_info || '-'}}</div>
                   <div *ngIf="p.analyst_remarks">Qualitative Analysis: <span [innerHtml]="p.analyst_remarks"></span></div>
                   
                    </div>
                  </div>
              </div>
              <!-- <div class="col-md-6">
                  <div class="formula">
                      <h2>Parameter Name</h2>
                      <p> <span>w =</span> Weight = <span>120</span></p>
                      <p><span>b =</span>Height = <span>30</span></p>
                      <h2>Formula = <span>(W*B) / 100</span> = 36 unit</h2>
                  </div>
              </div> -->
          </div>
          <!-- <div class="row m-2">
              <div class="col-md-6">
                  <div class="formula">
                      <h2>Parameter Name</h2>
                      <p> <span>w =</span> Weight = <span>120</span></p>
                      <p><span>b =</span>Height = <span>30</span></p>
                      <h2>Formula = <span>(W*B) / 100</span> = 36 unit</h2>
                  </div>
              </div>
              <div class="col-md-6">
                  <div class="formula">
                      <h2>Parameter Name</h2>
                      <p> <span>w =</span> Weight = <span>120</span></p>
                      <p><span>b =</span>Height = <span>30</span></p>
                      <h2>Formula = <span>(W*B) / 100</span> = 36 unit</h2>
                  </div>
              </div>
          </div> -->
      </td>
  </tr>

  <tr>
      <td class="text-center">6</td>
      <td colspan="10">
          <div class="row">
              <div class="col-md-6"> Name and Signature of analyst:  <span class="detail"> {{rawDatasheetDetails?.analyst_user.first_name}} {{rawDatasheetDetails?.analyst_user.last_name}} </span></div>
              <div class="col-md-6">Verified by: <span class="detail"> - </span></div>
          </div>
      </td>
  </tr>
  <tr>
      <td class="text-center">7</td>
      <td colspan="10">Remarks (If any):<span class="detail"> {{rawDatasheetDetails?.remarks}} </span> </td>
  </tr>
  <!-- <tr>
    <td class="text-center">8</td>
    <td colspan="10">Additional Information:<span class="detail"> {{rawDatasheetDetails?.additional_info || 'N/A'}} </span> </td>
</tr> -->
</table>
    <!-- </mat-card> -->
  </mat-dialog-content>
  <hr />

  <mat-dialog-actions align="end">
    <button (click)="closeDialog()" class="btn btn-danger btn-sm mx-1">Close</button>
    <!-- <button (click)="download()" class="btn btn-secondary btn-sm mx-1">Download</button> -->
    <!-- <button class="btn btn-primary btn-sm mx-1">
      <span *ngIf="!isLoading">Save</span>
      <span *ngIf="isLoading">
        <i class="fa fa-circle-o-notch fa-spin"></i> Loading...
      </span>
    </button> -->
  </mat-dialog-actions>
</div>
